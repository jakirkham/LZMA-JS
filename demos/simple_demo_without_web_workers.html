<head>
    <title>Simple Demo (Without Web Workers)</title>
    <meta http-equive="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<p>This is a very simple demonstration of <a href="http://github.com/nmrugg/LZMA-JS/">LZMA-JS</a>,
a browser-based implementation of the LZMA compression algorithm without the use of Web Workers.</p>

<textarea spellcheck=false id=compression_el>Hello, world.</textarea><br>
<button id=go>Go</button>
<script src="../src/lzma_worker.js"></script>
<script>

var compression_mode = 1,
    my_lzma = LZMA; /// lzma_worker.js creates a global LZMA object. We store it as a new variable just to match simple_demo.html.

function ab2str(buf) {
    return String.fromCharCode.apply(null, new Uint16Array(buf));
}

function str2ab(str) {
    var buf = new ArrayBuffer(str.length*2); // 2 bytes for each char
    var bufView = new Uint16Array(buf);
    for (var i=0, strLen=str.length; i < strLen; i++) {
      bufView[i] = str.charCodeAt(i);
    }
    return buf;
}

document.getElementById("go").onclick = function () {
    /// First, get the data.
    var data_raw = document.getElementById("compression_el").value;
    alert("Input: " + data_raw + "\nInput Type:" + data_raw.constructor);

    /// Convert it to an Array.
    var data_arr = new Uint8Array(str2ab(data_raw));
    alert("Input Array: " + data_arr + "\nInput Array Type:" + data_arr.constructor);

    /// Then, let's compress it.
    var data_compressed = my_lzma.compress(data_arr, compression_mode);
    alert("Compressed: " + data_compressed + "\nCompressed Type:" + data_compressed.constructor);
        
    /// Now, let's try to decompress it to make sure it works both ways.
    var data_decompressed = my_lzma.decompress(data_compressed);
    alert("Decompressed: " + data_decompressed + "\nDecompressed Type:" + data_decompressed.constructor);
}

</script>
</body>
